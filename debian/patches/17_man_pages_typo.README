Patches from Nicolas Fran√ßois.
